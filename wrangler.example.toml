name = "allegro-mcp-worker"
main = "src/worker.ts"
compatibility_date = "2025-06-18"
workers_dev = true
compatibility_flags = ["nodejs_compat"]

[vars]
# MCP protocol
MCP_PROTOCOL_VERSION = "2025-11-25"
MCP_TITLE = "Allegro MCP Server"
MCP_VERSION = "1.0.0"

# Auth flags
AUTH_ENABLED = "false"
AUTH_REQUIRE_RS = "false"
AUTH_ALLOW_DIRECT_BEARER = "false"

# OAuth provider configuration
# Set these to your provider's endpoints (GitHub, Spotify, Linear, etc.)
# Example for Spotify:
# PROVIDER_ACCOUNTS_URL = "https://accounts.spotify.com"
# Example for GitHub:
# PROVIDER_ACCOUNTS_URL = "https://github.com"

OAUTH_SCOPES = ""

# Redirect configuration
OAUTH_REDIRECT_ALLOW_ALL = "false"
OAUTH_REDIRECT_ALLOWLIST = "http://localhost:3000/callback"
OAUTH_REDIRECT_URI = "http://localhost:3000/callback"

# Environment
NODE_ENV = "development"

# DO NOT store secrets in [vars]; set via `wrangler secret put`
#
# Required secrets for OAuth:
#   wrangler secret put PROVIDER_CLIENT_ID
#   wrangler secret put PROVIDER_CLIENT_SECRET
#
# Required for KV encryption (HIGHLY RECOMMENDED for production):
#   # Generate a 32-byte base64url key:
#   openssl rand -base64 32 | tr -d '=' | tr '+/' '-_'
#   wrangler secret put TOKENS_ENC_KEY
#
# Without TOKENS_ENC_KEY, provider tokens are stored unencrypted in KV!

[[kv_namespaces]]
binding = "TOKENS"
# Create with: wrangler kv:namespace create TOKENS
# Replace with your KV namespace ID:
id = "YOUR_KV_NAMESPACE_ID"

# Preview KV namespace (for wrangler dev)
# [[kv_namespaces]]
# binding = "TOKENS"
# preview_id = "YOUR_PREVIEW_KV_NAMESPACE_ID"
